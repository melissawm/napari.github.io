
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/surface_timeseries.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_surface_timeseries.py>`
        to download the full example as a Python script or as a
        Jupyter notebook.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_surface_timeseries.py:


Surface timeseries
==================

Display a surface timeseries using data from nilearn

.. tags:: experimental

.. GENERATED FROM PYTHON SOURCE LINES 9-47



.. image-sg:: /gallery/images/sphx_glr_surface_timeseries_001.png
   :alt: surface timeseries
   :srcset: /gallery/images/sphx_glr_surface_timeseries_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_surf_nki_enhanced] Added README.md to /home/runner/nilearn_data
    [fetch_surf_nki_enhanced] Dataset created in 
    /home/runner/nilearn_data/nki_enhanced_surface
    [fetch_surf_nki_enhanced] Downloading data from 
    https://www.nitrc.org/frs/download.php/8470/pheno_nki_nilearn.csv ...
    [fetch_surf_nki_enhanced]  ...done. (1 seconds, 0 min)

    [fetch_surf_nki_enhanced] Downloading data from 
    https://www.nitrc.org/frs/download.php/8261/A00028185_rh_preprocessed_fsaverage5
    _fwhm6.gii ...
    [fetch_surf_nki_enhanced] Downloaded 17670144 of 42412120 bytes (41.7%%,    1.4s
    remaining)
    [fetch_surf_nki_enhanced]  ...done. (2 seconds, 0 min)

    [fetch_surf_nki_enhanced] Downloading data from 
    https://www.nitrc.org/frs/download.php/8260/A00028185_lh_preprocessed_fsaverage5
    _fwhm6.gii ...
    [fetch_surf_nki_enhanced] Downloaded 253952 of 42402060 bytes (0.6%%,  2.9min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 671744 of 42402060 bytes (1.6%%,  2.1min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 1269760 of 42402060 bytes (3.0%%,  1.7min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 2056192 of 42402060 bytes (4.8%%,  1.3min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 3006464 of 42402060 bytes (7.1%%,  1.1min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 3866624 of 42402060 bytes (9.1%%,  1.0min 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 4882432 of 42402060 bytes (11.5%%,   55.4s 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 6078464 of 42402060 bytes (14.3%%,   49.2s 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 7438336 of 42402060 bytes (17.5%%,   43.6s 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 8986624 of 42402060 bytes (21.2%%,   38.2s 
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 10682368 of 42402060 bytes (25.2%%,   33.5s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 12591104 of 42402060 bytes (29.7%%,   29.1s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 14639104 of 42402060 bytes (34.5%%,   25.2s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 16596992 of 42402060 bytes (39.1%%,   22.2s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 17956864 of 42402060 bytes (42.3%%,   20.8s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 19472384 of 42402060 bytes (45.9%%,   19.2s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 20848640 of 42402060 bytes (49.2%%,   17.9s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 22331392 of 42402060 bytes (52.7%%,   16.5s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 23953408 of 42402060 bytes (56.5%%,   14.9s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 25722880 of 42402060 bytes (60.7%%,   13.2s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 27664384 of 42402060 bytes (65.2%%,   11.4s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 29802496 of 42402060 bytes (70.3%%,    9.5s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 32137216 of 42402060 bytes (75.8%%,    7.5s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 34660352 of 42402060 bytes (81.7%%,    5.5s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 37216256 of 42402060 bytes (87.8%%,    3.6s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 39436288 of 42402060 bytes (93.0%%,    2.0s
    remaining)
    [fetch_surf_nki_enhanced] Downloaded 41992192 of 42402060 bytes (99.0%%,    0.3s
    remaining)
    [fetch_surf_nki_enhanced]  ...done. (28 seconds, 0 min)







|

.. code-block:: Python

    from importlib.metadata import version

    from nilearn import datasets, surface
    from packaging.version import parse

    import napari

    if parse(version("numpy")) >= parse('1.24') and parse(version("nilearn")) < parse('0.10.1'):
        raise RuntimeError(
            'Incompatible numpy version. '
            'You must have numpy less than 1.24 for nilearn 0.10.1 and below to '
            'work and download the example data'
        )


    # Fetch datasets - this will download dataset if datasets are not found
    nki_dataset = datasets.fetch_surf_nki_enhanced(n_subjects=1)
    fsaverage = datasets.fetch_surf_fsaverage()

    # Load surface data and resting state time series from nilearn
    brain_vertices, brain_faces = surface.load_surf_data(fsaverage['pial_left'])
    brain_vertex_depth = surface.load_surf_data(fsaverage['sulc_left'])
    timeseries = surface.load_surf_data(nki_dataset['func_left'][0])
    # nilearn provides data as n_vertices x n_timepoints, but napari requires the
    # vertices axis to be placed last to match NumPy broadcasting rules
    timeseries = timeseries.transpose((1, 0))

    # create an empty viewer
    viewer = napari.Viewer(ndisplay=3)

    # add the mri
    viewer.add_surface((brain_vertices, brain_faces, brain_vertex_depth), name='base')
    viewer.add_surface((brain_vertices, brain_faces, timeseries),
                        colormap='turbo', opacity=0.9,
                        contrast_limits=[-1.5, 3.5], name='timeseries')

    if __name__ == '__main__':
        napari.run()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 33.155 seconds)


.. _sphx_glr_download_gallery_surface_timeseries.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: surface_timeseries.ipynb <surface_timeseries.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: surface_timeseries.py <surface_timeseries.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: surface_timeseries.zip <surface_timeseries.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
